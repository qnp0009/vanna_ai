[
  {
    "ddl": "CREATE TABLE categories (\n    id INTEGER PRIMARY KEY,\n    name TEXT\n)"
  },
  {
    "ddl": "CREATE TABLE products (\n    id INTEGER PRIMARY KEY,\n    name TEXT,\n    description TEXT,\n    category_id INTEGER,\n    FOREIGN KEY (category_id) REFERENCES categories(id)\n)"
  },
  {
    "ddl": "CREATE TABLE orders (\n    order_id INTEGER,\n    date_created TEXT,\n    date_modified TEXT,\n    order_code INTEGER,\n    order_detail_id INTEGER  PRIMARY KEY,\n    product_id INTEGER,\n    gross_amount_after_tax REAL,\n    discount_code TEXT,\n    discount_amount REAL,\n    discount_percent REAL,\n    order_status TEXT,\n    fullname TEXT,\n    city TEXT,\n    state_region TEXT,\n    country TEXT,\n    gateway_id TEXT,\n    customer_id INTEGER,\n    cancel_reason TEXT,\n    tax_rate_raw REAL,\n    order_source TEXT,\n    is_free_shipping INTEGER,\n    FOREIGN KEY (product_id) REFERENCES products(id)\n)"
  },
  {
    "question": "Which city has the highest total sales in the last 6 months?",
    "sql": "\nWITH city_stats AS (\n    SELECT city AS location,\n           'City' AS location_type,\n           COUNT(*) AS order_count,\n           SUM(gross_amount_after_tax) AS total_order_value\n    FROM orders\n    WHERE DATE(substr(date_created, 1, 10)) >= DATE('now', '-6 months')\n    AND city IS NOT NULL\n    GROUP BY city\n)\nSELECT location, order_count, total_order_value\nFROM city_stats\nORDER BY total_order_value DESC\nLIMIT 1;\n"
  },
  {
    "question": "How many orders were cancelled and what were the common reasons?",
    "sql": "\nSELECT cancel_reason, COUNT(*) AS count\nFROM orders\nWHERE order_status = 'cancelled'\nGROUP BY cancel_reason\nORDER BY count DESC;\n"
  },
  {
    "question": "What is the average gross amount per country?",
    "sql": "\nSELECT country, AVG(gross_amount_after_tax) AS avg_order_value\nFROM orders\nWHERE country IS NOT NULL\nGROUP BY country\nORDER BY avg_order_value DESC;\n"
  },
  {
    "question": "What is the most used discount code?",
    "sql": "\nSELECT discount_code, COUNT(*) AS usage_count\nFROM orders\nWHERE discount_code IS NOT NULL\nGROUP BY discount_code\nORDER BY usage_count DESC\nLIMIT 1;\n"
  },
  {
    "question": "What are the total orders per category?",
    "sql": "\nSELECT c.name AS category_name, COUNT(*) AS total_orders\nFROM orders o\nJOIN products p ON o.product_id = p.id\nJOIN categories c ON p.category_id = c.id\nGROUP BY c.name\nORDER BY total_orders DESC;\n"
  },
  {
    "documentation": "\n-- Database stores e-commerce data with 3 main tables:\n1. orders: includes data about transactions, customers, pricing, location, and status.\n2. products: describes the product name, description, and category.\n3. categories: product categories like electronics, clothing, etc.\n\n-- Date Format Handling:\n- All date columns (e.g., date_created) are in TEXT format with `YYYY-MM-DD HH:MM:SS`.\n- When filtering by time, extract the date using `substr(date_created, 1, 10)` and compare with `DATE()`.\n\n-- Interpretation of ambiguous terms:\n- 'Significant' means a large number or value, usually defined by top-ranking or higher than average.\n- 'Minor' means small number/value, often at the bottom or under a threshold (e.g. < 100 orders).\n- 'Interesting' means unusual, surprising, or potentially insightful patterns in the data. These often require custom criteria (e.g., sudden spikes or anomalies).\n"
  }
]